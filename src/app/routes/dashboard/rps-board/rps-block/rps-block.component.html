<div class="chartContainer" style="padding-left: 10px; padding-right: 10px;">

  <div nz-row [ngStyle]="{'height':(isFourBlock?4:6)+'%'}">
    <app-head *ngIf="!isFourBlock" [workShop]="workShop"></app-head>

    <div nz-row *ngIf="isFourBlock">
      <div nz-col nzSpan="12" nzOffset="6" style="text-align: center;">
        <span style="color:#1e91de;line-height: 1;text-align: center;cursor: pointer;"
          [style.font-size]="fontSizeTitle1+'px'" (click)="isVisible=true;">
          {{workShop.workShopCode}}
        </span>
        <i nz-icon [nzType]="rpsBoardService.isFullscreen?'fullscreen-exit':'fullscreen'"
          style="cursor: pointer;color: #fff;" (click)="fullscreen()" nzTheme="outline"
          [style.font-size]="fontSizeTitle1+'px'"></i>
      </div>
      <!-- <div nz-col nzSpan="6" style="text-align: right;">
          <i nz-icon [nzType]="rpsBoardService.isFullscreen?'fullscreen-exit':'fullscreen'" style="cursor: pointer;color: #fff;" (click)="fullscreen()" nzTheme="outline"   [style.font-size]="fontSizeTitle1+'px'"></i>
        </div> -->

    </div>




  </div>
  <div nz-row [nzGutter]="4" [ngStyle]="{'height':(isFourBlock?94:92)+'%'}">
    <div nz-col [nzSpan]="(rightData.length>0 || rpsBoardService.isFour) ?21:23" style="height: 100%;">
      <div nz-row [nzGutter]="8" style="color: aliceblue;height:96.5%; border:0px solid #c1eb06;margin-top: 5px;">
        <!-- 上层  -->
        <div nz-col nzXs="24" nzLg="8" style="height: 100%;border:0px solid #c1eb06; padding-right: 10px;">
          <!-- 上层 左  -->
          <div nz-row style="height: 100%;">
            <div nz-col nzXs="24" nzLg="24" style="height: 100%; background:#192B53;">
              <div
                style="height: 5%;display: flex;align-items: center;justify-content: space-between; padding-left:8px;padding-right:8px;">

                <div>
                  <span style="color:#1e91de;text-align: center;" [style.font-size]="fontSizeTitle2+'px'">
                    <i nz-icon nzType="database" nzTheme="twotone"></i>
                    {{allData[0][0].title}} 总效率:&nbsp;{{(tableSMT?.efficiency*100 || 0) | number:'.0-1'}}%
                  </span>
                </div>
                <div *ngIf="!isFourBlock">
                  <span [style.font-size]="(fontSizeTitle2-4)+'px'">
                    排班：{{signSection3[allData[0][0].key]}} 考勤：{{signSection2[allData[0][0].key]}}
                    签到：{{signSection[allData[0][0].key]}}
                  </span>
                </div>
              </div>

              <div style="height: 94.5%;">
                <nz-spin *ngIf="allData[0][0].isLoading" [nzSpinning]="allData[0][0].isLoading"></nz-spin>
                <app-rps-table *ngIf="!allData[0][0].isLoading" [data]="allData[0][0].data" [tableSize]="tableSize"
                  #tableSMT [workShop]="workShop" [key]="allData[0][0].title"></app-rps-table>
                <!-- <div nz-row>
                  <div nz-col nzSpan="12" style="padding-right: 2px;">
                    <app-rps-table *ngIf="!allData[0][0].isLoading" [data]="allData[0][0].data" [tableSize]="tableSize"
                      [workShop]="workShop" [key]="allData[0][0].title"></app-rps-table>
                  </div>
                  <div nz-col nzSpan="12">
                    <app-rps-table *ngIf="!allData[0][0].isLoading" [data]="allData[0][0].data" [tableSize]="tableSize"
                      [workShop]="workShop" [key]="allData[0][0].title"></app-rps-table>
                  </div>

                </div> -->


              </div>

            </div>
          </div>

        </div>

        <div nz-col nzXs="24" nzLg="8" style="height: 100%;border:0px solid #c1eb06; padding-right: 10px;">
          <!-- 上层 左  -->
          <div nz-row style="height: 100%;">
            <div nz-col nzXs="24" nzLg="24" style="height: 50%; background:#192B53;">
              <div
                style="height: 10%;display: flex;align-items: center;justify-content: space-between; padding-left:8px;padding-right:8px;">

                <div>
                  <span style="color:#1e91de;text-align: center;" [style.font-size]="fontSizeTitle2+'px'">
                    <i nz-icon nzType="database" nzTheme="twotone"></i>
                    {{allData[0][1].title}} 总效率:&nbsp;{{(tableWAVE?.efficiency*100 || 0) | number:'.0-1'}}%
                  </span>
                </div>
                <div *ngIf="!isFourBlock">
                  <span [style.font-size]="(fontSizeTitle2-4)+'px'">
                    排班：{{signSection3[allData[0][1].key]}} 考勤：{{signSection2[allData[0][1].key]}}
                    签到：{{signSection[allData[0][1].key]}}
                  </span>
                </div>
              </div>

              <div style="height: 89.5%;">
                <nz-spin *ngIf="allData[0][1].isLoading" [nzSpinning]="allData[0][1].isLoading"></nz-spin>
                <app-rps-table *ngIf="!allData[0][1].isLoading" [data]="allData[0][1].data" [tableSize]="tableSize"
                  #tableWAVE [workShop]="workShop" [key]="allData[0][1].title"></app-rps-table>

              </div>

            </div>
            <div nz-col nzXs="24" nzLg="24" style="height: 50%; background:#192B53;">
              <div
                style="height: 10%;display: flex;align-items: center;justify-content: space-between; padding-left:8px;padding-right:8px;">

                <div>
                  <span style="color:#1e91de;text-align: center;" [style.font-size]="fontSizeTitle2+'px'">
                    <i nz-icon nzType="database" nzTheme="twotone"></i>
                    {{allData[1][0].title}} 总效率:&nbsp;{{(tableCOATING?.efficiency*100 || 0) | number:'.0-1'}}%
                  </span>
                </div>
                <div *ngIf="!isFourBlock">
                  <span [style.font-size]="(fontSizeTitle2-4)+'px'">
                    排班：{{signSection3[allData[1][0].key]}} 考勤：{{signSection2[allData[1][0].key]}}
                    签到：{{signSection[allData[1][0].key]}}
                  </span>
                </div>
              </div>

              <div style="height: 89.5%;">
                <nz-spin *ngIf="allData[1][0].isLoading" [nzSpinning]="allData[1][0].isLoading"></nz-spin>
                <app-rps-table *ngIf="!allData[1][0].isLoading" [data]="allData[1][0].data" [tableSize]="tableSize"
                  #tableCOATING [workShop]="workShop" [key]="allData[1][0].title"></app-rps-table>
                <!-- <div nz-row>
                  <div nz-col nzSpan="12">
                    <app-rps-table *ngIf="!allData[1][0].isLoading" [data]="allData[1][0].data" [tableSize]="tableSize"
                      [workShop]="workShop" [key]="allData[1][0].title"></app-rps-table>
                  </div>
                  <div nz-col nzSpan="12">
                    <app-rps-table *ngIf="!allData[1][0].isLoading" [data]="allData[1][0].data" [tableSize]="tableSize"
                      [workShop]="workShop" [key]="allData[1][0].title"></app-rps-table>
                  </div>

                </div> -->

              </div>

            </div>
          </div>

        </div>

        <div nz-col nzXs="24" nzLg="8" style="height: 100%;border:0px solid #c1eb06; padding-right: 10px;">
          <!-- 上层 左  -->
          <div nz-row style="height: 100%;">
            <div nz-col nzXs="24" nzLg="24" style="height: 100%; background:#192B53;">
              <div
                style="height: 5%;display: flex;align-items: center;justify-content: space-between; padding-left:8px;padding-right:8px;">

                <div>
                  <span style="color:#1e91de;text-align: center;" [style.font-size]="fontSizeTitle2+'px'">
                    <i nz-icon nzType="database" nzTheme="twotone"></i>
                    {{allData[1][1].title}} 总效率:&nbsp;{{(tableATP?.efficiency*100 || 0) | number:'.0-1'}}%
                  </span>
                </div>
                <div *ngIf="!isFourBlock">
                  <span [style.font-size]="(fontSizeTitle2-4)+'px'">
                    排班：{{signSection3[allData[1][1].key]}} 考勤：{{signSection2[allData[1][1].key]}}
                    签到：{{signSection[allData[1][1].key]}}
                  </span>
                </div>
              </div>

              <div style="height: 94.5%;">
                <nz-spin *ngIf="allData[1][1].isLoading" [nzSpinning]="allData[1][1].isLoading"></nz-spin>
                <app-rps-table *ngIf="!allData[1][1].isLoading" [data]="allData[1][1].data" [tableSize]="tableSize"
                  #tableATP [workShop]="workShop" [key]="allData[1][1].title"></app-rps-table>
              </div>

            </div>
          </div>

        </div>





      </div>
      <!-- <div nz-row>
        <nz-table   #middleTable nzTemplateMode nzSize="middle" nzShowPagination="false">
          <thead>
            <tr>
              <th>总生产工时</th>
              <th>总签到工时</th>
              <th>考勤总人数</th>
              <th>在线签到总人数</th>
              <th>离线签到总人数</th>
              <th>在线总效率</th>
              <th>离线总效率</th>    
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>总生产工时</td>
              <td>总签到工时</td>
              <td>考勤总人数</td>
              <td>在线签到总人数</td>
              <td>离线签到总人数</td>
              <td>在线总效率</td>
              <td>离线总效率</td>    
            </tr>
          </tbody>
        </nz-table>
      </div> -->
      <div *ngIf="!isFourBlock" nz-row [nzGutter]="4" style="margin-top: 4px;height: 2.5%;">
        <div style=" display: flex;flex-wrap: nowrap; align-items:center;justify-content: center;">
          <div style="margin-right: 10px;">
            <nz-select nzSize="small" [(ngModel)]="rpsBoardService.changePageTime"
              (ngModelChange)="rpsBoardService.pageChangeTime$.next($event)">
              <nz-option [nzValue]="15" nzLabel="15秒翻页"></nz-option>
              <nz-option [nzValue]="30" nzLabel="30秒翻页"></nz-option>
              <nz-option [nzValue]="60" nzLabel="60秒翻页"></nz-option>
            </nz-select>
          </div>
          <div>
            <span style="color: #ffffff;font-size: 16px;">达成率：</span>
            <nz-tag nzColor="#f5222d">{{rpsBoardService.standard.complete.bad}}%↓</nz-tag>
            <nz-tag nzColor="#c2af04">
              {{rpsBoardService.standard.complete.bad}}%~{{rpsBoardService.standard.complete.good}}%
            </nz-tag>
            <nz-tag nzColor="#52c41a">{{rpsBoardService.standard.complete.good}}%↑</nz-tag>
          </div>
          <div> <span style="color: #ffffff;font-size: 16px;">良品率：</span>
            <nz-tag nzColor="#f5222d">{{rpsBoardService.standard.yield.bad}}%↓</nz-tag>
            <nz-tag nzColor="#c2af04">{{rpsBoardService.standard.yield.bad}}%~{{rpsBoardService.standard.yield.good}}%
            </nz-tag>
            <nz-tag nzColor="#52c41a">{{rpsBoardService.standard.yield.good}}%↑</nz-tag>
          </div>
          <div> <span style="color: #ffffff;font-size: 16px;">效　率：</span>
            <nz-tag nzColor="#f5222d">{{rpsBoardService.standard.efficiency.bad}}%↓</nz-tag>
            <nz-tag nzColor="#c2af04">
              {{rpsBoardService.standard.efficiency.bad}}%~{{rpsBoardService.standard.efficiency.good}}%
            </nz-tag>
            <nz-tag nzColor="#52c41a">{{rpsBoardService.standard.efficiency.good}}%↑</nz-tag>
          </div>

        </div>







      </div>
    </div>
    <div nz-col [nzSpan]="(rightData.length>0 || rpsBoardService.isFour)?3:1" style="height: 100%;" #errorBox>
      <div nz-row class="shiftInfo-title" style="margin-top: 5px;" #errodHead nzType="flex" nzAlign="middle">

        <div nz-col nzSpan="6" *ngIf="rightData.length>0">
          <i nz-icon [ngStyle]="{'font-size':errorIconSize+'px'}"
            [ngClass]="{'errorIcon': isError,'successIcon':!isError}">
            <svg>
              <path
                d="M518.827 150.187c20.48 0 37.546-17.067 37.546-37.547V37.547C556.373 17.067 539.307 0 518.827 0S481.28 17.067 481.28 37.547v75.093c0 20.48 17.067 37.547 37.547 37.547z m283.306 75.093l51.2-51.2c13.654-13.653 13.654-37.547 0-51.2-13.653-13.653-37.546-13.653-51.2 0l-51.2 51.2c-13.653 13.653-13.653 37.547 0 51.2 13.654 17.067 37.547 17.067 51.2 0z m-563.2 0c13.654 13.653 37.547 13.653 51.2 0 17.067-13.653 17.067-37.547 3.414-51.2l-54.614-51.2c-13.653-13.653-37.546-13.653-51.2 0-13.653 13.653-13.653 37.547 0 51.2l51.2 51.2zM47.787 467.627h75.093c20.48 0 37.547-17.067 37.547-37.547 0-20.48-17.067-37.547-37.547-37.547H47.787c-20.48 0-37.547 17.067-37.547 37.547 0 20.48 17.067 37.547 37.547 37.547z m863.573 0h75.093c20.48 0 37.547-17.067 37.547-37.547 0-20.48-17.067-37.547-37.547-37.547H911.36c-20.48 0-37.547 17.067-37.547 37.547 0 20.48 17.067 37.547 37.547 37.547zM986.453 901.12H819.2V525.653c0-163.84-136.533-300.373-300.373-300.373S218.453 361.813 218.453 525.653V901.12H47.787c-20.48 0-37.547 17.067-37.547 37.547s17.067 37.546 37.547 37.546h938.666c20.48 0 37.547-17.066 37.547-37.546s-17.067-37.547-37.547-37.547zM518.827 447.147L634.88 645.12l-119.467 13.653 20.48 150.187-133.12-194.56 122.88-17.067-6.826-150.186z">
              </path>
            </svg>
          </i>
        </div>
        <div nz-col nzSpan="12" [nzOffset]="isError?0:6">
          异常信息({{rightData.length}})
        </div>

      </div>
      <ng-container *ngFor="let item of rightShow;index as i">
        <app-error-item [item]="item" ryDomVisible (visible)="visible($event,item,i)"
          (showErrorDetail)="showErrorDetail($event);"></app-error-item>

      </ng-container>

    </div>
  </div>




</div>

<nz-modal [(nzVisible)]="isVisibleErrorDetail" [nzWidth]="720" (nzOnCancel)="isVisibleErrorDetail=false;"
  [nzStyle]="{ top: '200px' }" [nzOkText]="null" [nzCancelText]="null" [nzBodyStyle]="{'background': '#192b53'}"
  [nzFooter]="null">
  <app-error-detail *ngIf="currentErrorInfo" [currentErrorInfo]="currentErrorInfo"></app-error-detail>


</nz-modal>

<nz-modal [(nzVisible)]="isVisible" [nzWidth]="1200" (nzOnCancel)="isVisible=false;" [nzStyle]="{ top: '200px' }"
  [nzOkText]="null" [nzCancelText]="null" [nzBodyStyle]="{'background': '#192b53'}" [nzFooter]="null">
  <div class="gutter-example">
    <div nz-row nzGutter="16">
      <div nz-col nzSpan="6" *ngFor="let item of rpsBoardService.workshops"
        style="border:1px solid #000;color: #fff;cursor: pointer;" (click)="change(item)">
        <div style="font-size:xx-large;">{{item.workShopCode}}</div>
        <!-- <div style="font-size:xx-large;">{{item.workShopCodeDes}}</div> -->
      </div>

    </div>
  </div>

</nz-modal>